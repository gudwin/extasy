// Extasy CMS Dashboard scripts v 4.3
jQuery( function ($) {
    var timeout = 60000;
    var auditSelector = '.navButtons .audit';
    var updateFunc = function () {
        api.request({
            methodName : 'Audit.NewMessages',
            onSuccess : function ( response ) {
                response = parseInt( response );
                $('.navButtons .audit span').remove();
                if ( response ) {
                    $('.navButtons .audit a').append('<span class="badge">' + response +'</span>');
                } else {
                }
            }

        })
    };
    if ( $(auditSelector).length > 0 ) {
        updateFunc();
        window.setInterval( function () {
            updateFunc();
        }, timeout);
    }

});
jQuery(function ($) {
    var searchModule = angular.module( 'DashboardSearch', [
        'ui.bootstrap',
        'ui.date',
        'extasyApiModule'
    ] );
    searchModule.controller('Search',['$scope','extasyApi', function ($scope, $extasyApi) {
        $scope.search = 'Hello world!';
    }]);
    angular.bootstrap(jQuery('#HistoryApplication').get(0), ['historyApp']);
    var searchForm = $('form[role=search]');

    var onChange = function (event, ui) {
        if (!ui.item) {
            return ;
        }
        searchForm.find('.title').val(ui.item.login);
    }

    searchForm.autocomplete({
        minLength: 2,
        source: self.config.searchURL,
        select: onChange,
        focus: onChange,
        change: onChange
    })

});